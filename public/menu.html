<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SlotEats - Men√∫</title>
    <style>
        :root { 
            --primary: #e84118; 
            --dark: #2f3542; 
            --light: #fef2f2; 
            --success: #27ae60;
        }

        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #fafafa; padding-bottom: 80px; }
        
        /* Header y Volver */
        header { background: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); sticky; top:0; z-index:100; }
        .btn-back { cursor: pointer; font-weight: bold; color: var(--primary); text-decoration: none; }

        /* Grid de Comida */
        .menu-container { padding: 20px; max-width: 800px; margin: 0 auto; }
        .food-card { 
            background: white; border-radius: 15px; padding: 15px; margin-bottom: 15px; 
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05); transition: 0.3s;
        }
        .food-info h3 { margin: 0; font-size: 18px; }
        .food-info p { margin: 5px 0; color: #666; font-size: 14px; }
        .price { color: var(--primary); font-weight: 900; font-size: 18px; }

        /* Bot√≥n Agregar */
        .btn-add { 
            background: var(--primary); color: white; border: none; padding: 10px 15px; 
            border-radius: 10px; cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .btn-add:hover { transform: scale(1.1); }

        /* üõçÔ∏è BOLSITA FLOTANTE */
        .cart-float {
            position: fixed; bottom: 25px; right: 25px; 
            background: var(--dark); color: white; width: 65px; height: 65px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 24px; cursor: pointer; box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 1000; transition: 0.3s;
        }
        .cart-count {
            position: absolute; top: 0; right: 0; background: var(--primary);
            color: white; font-size: 12px; width: 22px; height: 22px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: bold; border: 2px solid white;
        }

        /* üõí PANEL DEL CARRITO (Lateral) */
        #cartPanel {
            position: fixed; top: 0; right: -400px; width: 350px; height: 100%;
            background: white; z-index: 2001; box-shadow: -5px 0 25px rgba(0,0,0,0.2);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); padding: 25px; display: flex; flex-direction: column;
        }
        #cartPanel.active { right: 0; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        .btn-remove { color: var(--secondary); background: none; border: none; cursor: pointer; font-size: 12px; font-weight: bold; }

        /* Inputs Profesionales */
        .checkout-form input { 
            width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box;
        }
        .btn-geo { background: #f1f2f6; border: none; padding: 8px; border-radius: 8px; font-size: 12px; cursor: pointer; width: 100%; margin-bottom: 10px; }
        
        .btn-pay { 
            background: var(--success); color: white; border: none; width: 100%; padding: 15px; 
            border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer; margin-top: auto;
        }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; }
    </style>
</head>
<body>

<header>
    <a href="home.html" class="btn-back">‚¨Ö Volver</a>
    <div id="restauranteTitulo" style="font-weight: 900; font-size: 20px;">Men√∫</div>
    <div></div>
</header>

<div class="menu-container" id="menuLista">
    </div>

<div class="cart-float" onclick="toggleCart()">
    üçî
    <div class="cart-count" id="cartCount">0</div>
</div>

<div class="overlay" id="cartOverlay" onclick="toggleCart()"></div>

<div id="cartPanel">
    <h2 style="margin-top:0;">Mi Pedido ü•°</h2>
    <div id="cartItems" style="flex-grow: 1; overflow-y: auto;">
        </div>

    <div class="checkout-form">
        <hr>
        <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:20px; margin:15px 0;">
            <span>Total:</span> <span id="cartTotal">$0.00</span>
        </div>
        <input type="text" id="nombrePedido" placeholder="¬øA nombre de qui√©n?">
        <button class="btn-geo" onclick="obtenerUbicacion()">üìç Compartir mi ubicaci√≥n actual</button>
        <input type="text" id="ubicacionManual" placeholder="Direcci√≥n de entrega">
        <button class="btn-pay" onclick="finalizarPedido()">Enviar Pedido üöÄ</button>
    </div>
</div>

<script>
    // 1. Datos de comida (Simulados por ahora)
    const platillos = [
        { id: 1, nombre: "Monster Burger", desc: "Doble carne, tocino y mucho queso.", precio: 150, res: "Burger Galaxy" },
        { id: 2, nombre: "Pizza Peperoni", desc: "Masa artesanal y extra queso.", precio: 180, res: "Pizza Nostra" },
        { id: 3, nombre: "Sushi Master Roll", desc: "Salm√≥n fresco y aguacate.", precio: 220, res: "Sushi Master" },
        { id: 4, nombre: "Alitas BBQ", desc: "12 piezas crujientes.", precio: 130, res: "Chicken House" }
    ];

    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

    // 2. Renderizar men√∫
    function cargarMenu() {
        const urlParams = new URLSearchParams(window.location.search);
        const resNombre = urlParams.get('res');
        if(resNombre) document.getElementById('restauranteTitulo').innerText = resNombre;

        const html = platillos.map(p => `
            <div class="food-card">
                <div class="food-info">
                    <h3>${p.nombre}</h3>
                    <p>${p.desc}</p>
                    <span class="price">$${p.precio}</span>
                </div>
                <button class="btn-add" onclick="agregarAlCarrito(${p.id})">Agregar +</button>
            </div>
        `).join('');
        document.getElementById('menuLista').innerHTML = html;
        actualizarInterfazCarrito();
    }

    // 3. L√≥gica del Carrito
    function agregarAlCarrito(id) {
        const producto = platillos.find(p => p.id === id);
        carrito.push(producto);
        localStorage.setItem('carrito', JSON.stringify(carrito));
        actualizarInterfazCarrito();
        
        // Efecto visual de rebote en la bolsita
        const float = document.querySelector('.cart-float');
        float.style.transform = "scale(1.2)";
        setTimeout(() => float.style.transform = "scale(1)", 200);
    }

    function quitarDelCarrito(index) {
        carrito.splice(index, 1);
        localStorage.setItem('carrito', JSON.stringify(carrito));
        actualizarInterfazCarrito();
    }

    function actualizarInterfazCarrito() {
        document.getElementById('cartCount').innerText = carrito.length;
        const lista = document.getElementById('cartItems');
        let total = 0;

        if (carrito.length === 0) {
            lista.innerHTML = `<p style="text-align:center; color:#999; margin-top:50px;">Tu bolsita est√° vac√≠a üåÆ</p>`;
        } else {
            lista.innerHTML = carrito.map((p, index) => {
                total += p.precio;
                return `
                    <div class="cart-item">
                        <div>
                            <div style="font-weight:bold;">${p.nombre}</div>
                            <div style="font-size:11px; color:var(--primary);">${p.res}</div>
                            <div style="font-size:13px;">$${p.precio}</div>
                        </div>
                        <button class="btn-remove" onclick="quitarDelCarrito(${index})">‚ùå Quitar</button>
                    </div>
                `;
            }).join('');
        }
        document.getElementById('cartTotal').innerText = `$${total.toFixed(2)}`;
    }

    function toggleCart() {
        document.getElementById('cartPanel').classList.toggle('active');
        document.getElementById('cartOverlay').style.display = 
            document.getElementById('cartPanel').classList.contains('active') ? 'block' : 'none';
    }

    // 4. Extras Profesionales
    function obtenerUbicacion() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(pos => {
                const { latitude, longitude } = pos.coords;
                document.getElementById('ubicacionManual').value = `Ubicaci√≥n GPS: ${latitude.toFixed(4)}, ${longitude.toFixed(4)}`;
                alert("üìç Ubicaci√≥n obtenida correctamente.");
            });
        }
    }

    function finalizarPedido() {
        const nombre = document.getElementById('nombrePedido').value;
        if (!nombre || carrito.length === 0) return alert("Por favor agrega comida y tu nombre.");
        
        alert(`üöÄ ¬°Pedido enviado, ${nombre}!\nTotal: ${document.getElementById('cartTotal').innerText}\nPreparando tus ${carrito.length} platillos.`);
        
        // Limpiar carrito
        carrito = [];
        localStorage.removeItem('carrito');
        window.location.href = "home.html";
    }

    window.onload = cargarMenu;
</script>

</body>
</html>